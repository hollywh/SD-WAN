# JUNIPER AI-WAN(SD-WAN 3.0)解决方案

## 传统广域网

在深入研究SD-WAN之前，先来回顾一下过去网络通信是如何处理以及为什么采用这种方式处理的。

截止到目前，处理公司网络流量的主要方法是分支机构通过租用线路与公司数据中心或总公司联系，通常使用MPLS。这种方式约占公司网络流量的80％，其中WAN路由器是基于硬件的、专有的、昂贵且相对不灵活。

[![img](https://img1.sdnlab.com/wp-content/uploads/2020/10/sdwanprimer1.png)](https://img1.sdnlab.com/wp-content/uploads/2020/10/sdwanprimer1.png)

公司之所以使用这种模型，是因为它允许对路由器进行严格控制，并能够提供安全、可靠的服务质量。但是就跨国公司而言，各个国家通常都需要遵循各自的法规，因此必须经过非常复杂的安排才能建立真正的全球网络。

这就暴露出了广域网的局限性：即，WAN路由器的集中管理非常困难。在许多情况下，路由器需要通过设备后面的端口进行物理访问，并且需要使用专有的命令语言。

虽然这种情况已经在改善了，但目前仍有很多传统设备在使用。大多数WAN路由器在TCP层分离流量，因此无法将业务关键流量与不太紧急的流量分开，而且许多应用程序和进程都需要无抖动的网络连接。例如，VoIP语音应用。

另一个巨大的因素是成本，促使人们寻找摆脱传统WAN拓扑的方式。在传统的WAN部署中，每个网段都需要专用的物理硬件，这通常非常昂贵。即使很小的扩容、升级或重新配置也可能带来巨额的费用。MPLS和宽带之间的成本差异是巨大的。思科曾发布一个公开的案例研究，声称用SD-WAN替代MPLS可以节省70%的网络成本。



## SD-WAN

随着软硬件的发展，现在已经可以用软件实现传统WAN硬件设备的功能，基于软件的设备能够实时分析流量并做出明智的决策。还可以使用宽带和通用x86硬件或虚拟机（VM）创建大规模的overlay网络，这些网络可以复制传统广域网的所有功能，而成本只是传统广域网的一小部分。

SD-WAN可以创建成熟的专用网络，增加了动态共享网络带宽的能力，还可以实现中央控制、零接触配置、集成分析和按需电路配置，从而实现基于策略的集中式安全和管理。除此之外，SD-WAN还可以以较低的成本增加带宽。这种配置可实现最佳的速度，并具有限制低优先级应用程序的能力。

SD-WAN允许通过中央管理控制台对分支网络进行集中管理，从而无需对WAN路由器进行物理访问，也无需现场IT人员进行手动配置。它还提供了对网络的更多可见性，并为IT人员和中层管理人员提供了通用的网络视图。由于网络同时使用私有和公共传输介质来路由流量，因此这也为传输介质类型和传输供应商选择提供了更多选择。

MPLS的操作类似于交换机和路由器，位于第2层和第3层之间，并使用包转发技术和标签来制定数据转发策略。SD-WAN基于应用层路由流量，从而确保了用户体验。此外，SD-WAN技术可以根据需要监视和重新路由流量，以满足服务水平协议（SLA）。

SD-WAN的优势可以概括为三类：灵活性、可管理性和低成本：

**灵活性**：SD-WAN可以在可用的传输之间进行选择，在给定的时间为给定的应用程序选择最合适的传输，并且增加了在使用高峰期间将应用程序重新路由到不同传输的功能。它还可以设置策略，按需选择更昂贵或者更便宜的传输。最关键的一点是，控制带宽分配的是SD-WAN，而不是运营商。此外，由于SD-WAN组件是基于软件的，因此部署比较灵活，周期时间短。

**可管理性**：SD-WAN的中央管理控制台允许在需要时即时进行全局更改，例如在出现新的安全威胁或控制成本的情况下。SD-WAN还通过使用多个传输/网络运营商来增强网络连接，如果其中一个发生故障，则可以使用另一个，并且这种故障转移可以在几秒钟内完成。此外，SD-WAN还可以通过对所有流量或流量类别进行加密来帮助提高安全性。

**低成本**：SD-WAN技术可以通过以下几种方式帮助降低WAN连接的总体成本：通过删除或更换昂贵的租用线路（MPLS），允许集中管理和减少对IT人员的需求以及提供商用硬件部署能力。不过SD-WAN也有一些潜在的缺点。与MPLS相比，使用宽带服务的最大缺点是宽带更加不可预测，并且SLA无法保障。相比较而言，MPLS延迟更低和丢包少。很多公司都会选择使用MPLS来处理关键业务流量，而其他情况选择使用较便宜的宽带和4G/5G。



### 基于隧道或无隧道(SD-WAN3.0)的设计

隧道会产生数据包开销并增加分段存储。额外的数据和增加的处理开销会对吞吐量和性能产生负面影响。基于隧道的方法还会使扩展变得复杂并阻碍扩展，同时会导致跨备用路径的会话故障转移变慢。此外，即使通过隧道，也无法在传输过程中应用安全策略，直至后续的解封装允许从隧道端点后方进行检查、识别和分析。

![一张黑白图表：基于隧道的配置和封装](https://juniper-prod.scene7.com/is/image/junipernetworks/tunnel-based-configuration-and-encapsulation-diagram?fmt=png8-alpha&wid=1828&dpr=off)

<center>基于隧道的配置和封装</center>

![一张黑白图表：无隧道基于会话的可操纵性](https://juniper-prod.scene7.com/is/image/junipernetworks/tunnel-free-session-based-steerability-diagram?fmt=png8-alpha&wid=1739&dpr=off)

<center>无隧道基于会话的转发</center>

较新的无隧道方法可减少 SD-WAN  数据包开销，并维持最佳吞吐量，而无需使用成本高昂的封装。该方法还支持快速扩展，虽然不是无限扩展，但需要的资源和配置更少，以提供不断增长的任意点对点拓扑。无隧道还有助于更好地感知态势和会话，从而能够更早地引导流量并应用安全策略。

| 有隧道的SD-WAN                                               | 无隧道的SD-WAN                                               |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| 隧道转发数据包而不是会话，这导致连接的静态性质。为了实现会话感知，需要添加其他应用程序，例如 DPI。 无状态 L2 和 L3 网络结构。 | 会话转发，从而产生状态和动态路由，最终形成智能和分布式结构。 无状态的 L2 和 L3 网络转变为会话感知数据平面。 |
| 额外带宽开销可能高达 123%。                                  | 没有隧道包头开销就意味着没有带宽开销。                       |
| 如果 IP 数据包大小接近 1500，则存在切片的风险。 切片可能会导致重组过程中数据包丢失。 | 不存在切片风险（由于 SD‑WAN），因为不需要对开销字节进行额 外补偿。 |
| 由于隧道需要中心辐射配置而不是网状配置，因此存在可扩展性问题；对于 VoIP 和视频等实时流量来说，设计不是最优的。 | 由于没有开销，因此不存在可扩展性风险。可以创建数千个会话。与 IP 一样可扩展。 |
| 对于需要更粒度的分段的大型网络，分段的实现/维护是静态且复杂的。 | 基于会话的超分段。更精细，更易于实施，可提高 MPLS 链路的利用 率。这可以潜在地降低 MPLS 链路成本。 |
| 安全风险可能因切片而产生。 通过隧道技术进行逃避攻击可能会给基于网络的安全设备（如网络防火墙、IDS 和 IPS）带来问题 由于传统 SD‑WAN 可能存在双重加密，并且即使客户流量已加密也可能会重新加密，因此效率低下 | 默认零信任安全 端到端状态会话管理和加密。无需 IPSec，因为可以使用 AES‑128/256对有效载荷进行加密。 通过检测客户流量的加密进行自适应加密；无需重新加密流量。 |


## SD-WAN 部署

如上所述，SD-WAN 可能有多种形式（和规格尺寸），而最受欢迎的形式涉及最少的现实环境摩擦。有些场景会使用本地设备或白盒，但大多数 SD-WAN 架构和解决方案提供虚拟机和虚拟化网路功能，可以在现有服务器和路由器上完全通过软件配置。

正如传统的 WAN 在站点、资产和服务之间提供连接和传输一样，SD-WAN 可以将智能边缘或网格扩展到任何有托管实体或代理的地方（即使采用非托管的底层基础架构）：

- 分支机构和远程办公室到企业
- 分布式园区
- 数据中心到数据中心
- 远程访问
- 企业到公共云或私有云
- CSP 或 ISP 核心/边缘

由于 SD-WAN 不是一项明确的协议或技术，许多 SD-WAN 叠加层的实施都会利用不同的底层有线和无线传输或技术，包括但不限于基于 MPLS VPN、DSL 和 5G/LTE（或其他无线回程）的 SD-WAN。
                                   ##   SD-WAN 的关键            

### 以用户体验为中心

我们通常会假设，组织清楚了解使用 WAN 的人员和设备。但是，只有在对流量和会话进行分析后，组织才能真正了解实际用户是谁及其用例真正包括哪些内容。

久而久之，网络使用会在基于机器的代理和用户发起的流量之间产生振荡和交替。WAN 本身是一种有限的资源，随着流量模式的变化，某些会话和流量会遭遇拥塞状况。这些会话可以而且应该立即通过替代路径进行优先计划分或引导，但情况并非总是如此。

拥塞的路径无法满足实时通信的需求，这一直是 WAN 服务交付的难点。前几代 SD-WAN 解决方案主要提供使用  QoS（服务质量）标记和列队策略的静态实施，但很少能通过动态影响及引导个别会话来实时改进用户标记的体验。某些 SD-WAN  解决方案甚至可以提供对称的会话路径来优化性能和策略遵从性。

会话感知是现代 SD-WAN  解决方案的重要组成部分。它从用户的角度提供了针对网络的最真实观点。会话是暂时的且涉及特定的应用流量，这些流量的质量可能有很大差异（原因包括容量、延迟、拥塞和间歇性中断等因素）。会话感知比标准应用识别更进一步，智能交换矩阵可使用会话感知为每个用户或代理逐一引导个别会话。通过采用更加整体和统一的观点，结合路由流量的精细化功能，某些 SD-WAN 解决方案可以根据服务级别目标等标准，自动提升、降级或选择性地引导这些会话。个别会话已成为网络运营商提供卓越用户体验的终极标准。

### WAN 保证

保证是提供信心的一种手段。WAN  至关重要，不仅适用于连接站点，还适用于访问服务和资源，以及加快工作流程。信心可以让人高枕无忧。无论是配置新位置、扩展容量，还是帮助确保安全和运营团队获得正确的工具和支持，网络运营商都需要拥有合适的能力。运营不止是运行良好，更重要的是，有效进行故障转移并最大限度减少损害。中断和拥塞可能会发生，但通过智能叠加，就可以减少担心 [MTBF（平均故障间隔时间）](https://en.wikipedia.org/wiki/Mean_time_between_failures)和 [MTTR（平均维修时间）](https://en.wikipedia.org/wiki/Mean_time_to_repair)的时间。

![image-20240606122631930](http://kokit.55555.io:49999/a62743a7890bfb99ba23443dc671b822.png)

过去，IT 团队受传统路由协议的指标或折衷的限制；现在，他们可以选择虚拟化 WAN 本身，同时添加新的智能层和更优的功能速度。SD-WAN 承诺对数据包及其流量进行更精细的控制，并为如何实现从更优的安全策略到更完善的成本控制提供了无限可能，同时改进了用户体验。

### Connected Security 和 SASE

安全关乎风险。在无边界和数字化威胁不断加速的环境中，各大组织都在努力保护其资产、服务和员工。越来越多的数字安全问题日益影响安全。与蓄意攻击相关的风险也已开始影响其他运营要素。数字连接和控制越多，需要保护的数字攻击面就越大。

长期以来，安全架构一直试图限制和分离故障域，以防止故障的传播，但如何做到这一点又不会对工作流和流程的流畅运行产生不利影响，确实是个难题。SASE（安全接入服务边缘）提供在可信边界交付的各种安全功能，可限制与远程访问解决方案相关的传统开销。

如果将 SD-WAN 理解为服务的概念交付模型，即可将其理解为很多最佳安全实践的基础。这不是 SD-WAN 与SASE 的问题，而是  SD-WAN 提供 SASE 基础构建基块知识的问题。网络仍是很多安全控制的最佳场所之一。WAN  边缘可创建高效且有效的策略实施点，而且提供观测和控制区域边界的更好方式以及相关的安全要求。借助  ZTNA（零信任网络访问），与不太安全的“默认许可”相比，访问稳稳地落在“默认拒绝”状态，这是最有利和最稳健的状态。

![一张黑白图表：零信任网络访问](https://juniper-prod.scene7.com/is/image/junipernetworks/zero-trust-network-access-ztna-diagram?wid=1776&dpr=off)

<center>零信任网络访问</center>

其余的挑战是帮助确保复杂性得到控制和管理。当微分段和微许可受精细化 IAM（身份访问管理）的约束时，手动分配许可、访问和角色就变得过于繁琐。组织越来越多地转向自动化和基于软件的解决方案来处理 IAM。

SD-WAN 随时准备兑现承诺：通过尽可能强化最强大的策略实施点（网络）来提高安全性、增强信心并减少繁琐的工作。



## AIOps 的优势

AI（人工智能）及其衍生技术之一的  ML（机器学习）可以在整个网域中提供巨大的价值。具有众所周知的功能和协议（如数据网络）的问题领域已经成熟，可在多种场景中使用机器学习。在这些定义明确的问题领域中，除了实现更优的网络连接和安全性，还可以轻松消除 AI 偏差，进而带来实打实的成果。搭配使用混合和更快速的学习方法（如[迁移学习](https://en.wikipedia.org/wiki/Transfer_learning)）训练机器学习，然后使用生产数据增强 AI，即可快速建立信任。准确的洞察和建议的补救措施将随即出现，而且可以快速加以验证。

数据网络是一个运营数据和遥测的数量和速度不断超越传统方式、与时俱进的领域。网络即图形。AI 和 ML 可提供对图形及其相依关系的切实可行且快速的洞察，包括从识别复杂的根本原因到提供更好的接口来定位并管理不断增加的网络复杂性的所有内容。

[AIOps（适用于 IT 运维的人工智能）](https://www.juniper.net/cn/zh/research-topics/what-is-aiops.html)是一种技术实践，旨在通过将诸多繁重的日常重复性工作和低价值工作自动化，来减轻网络运营商的负担。将人才投入到更具战略性的挑战中，并让更多人理解我们周围不断增长的网络和复杂性，是开展创新的关键一步。
